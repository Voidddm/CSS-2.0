<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario de Inicio de Sesión</title>
</head>
<body>
    <h2>Inicio de Sesión</h2>
    <form action="login.php" method="GET">
        <label for="username">Nombre de Usuario:</label><br>
        <input type="text" id="username" name="username"><br>
        <label for="password">Contraseña:</label><br>
        <input type="password" id="password" name="password"><br><br>
        <input type="submit" value="Iniciar Sesión">
    </form>

    <?php
    if ($_SERVER["REQUEST_METHOD"] == "GET") {
        // Datos de conexión a la base de datos
        $servername = "db-2024.mysql.database.azure.com";
        $db_username = "jim";
        $db_password = "2839064Void";
        $dbname = "db-ticket";

        // Crear conexión
        $conn = new mysqli($servername, $db_username, $db_password, $dbname);

        // Verificar conexión
        if ($conn->connect_error) {
            die("Connection failed: " . $conn->connect_error);
        }

        // Recibir los datos del formulario
        $username = $_GET['username'];
        $password = $_GET['password'];

        // Consulta SQL para verificar el usuario y la contraseña
        $sql = "SELECT * FROM clientes WHERE cliente_id = '$username' AND pass = '$password'";
        $result = $conn->query($sql);

        if ($result->num_rows > 0) {
            // Si hay al menos un resultado, el usuario y la contraseña son correctos
            // Redirigir a home.html
            echo "<script>window.location.href = 'home.html';</script>";
            exit(); // Asegura que el script se detenga aquí y no siga ejecutándose
        } else {
            // Si no hay resultados, el usuario y/o la contraseña son incorrectos
            echo "Usuario y/o contraseña incorrectos";
        }

        $conn->close();
    } else {
        echo "Acceso denegado";
    }
    ?>
</body>
</html>
